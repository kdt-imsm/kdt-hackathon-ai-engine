<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Rural Planner Test</title>
  </head>
  <body>
    <h2>ğŸ§ª ìì—°ì–´ â†’ ì¼ì • í…ŒìŠ¤íŠ¸</h2>
    <textarea id="input" rows="3" cols="60">
7ì›” í•œ ë‹¬ ì „ë¶ ê³ ì°½ì—ì„œ ì¡°ê°œì¡ì´ ì²´í—˜ê³¼ ì‚¬ì°° ê´€ê´‘ í•˜ê³  ì‹¶ì–´
</textarea
    ><br />
    <button onclick="run()">Generate</button>

    <pre id="out"></pre>

    <script>
      async function run() {
        const query = document.getElementById("input").value;
        let res = await fetch("/slots", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ query }),
        });
        const slots = await res.json();

        res = await fetch("/recommend", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ ...slots, email: "tester@ex.com" }),
        });
        const recs = await res.json();

        // pick first two items for demo
        const selections = recs.slice(0, 2);
        res = await fetch("/itinerary", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ selections, slots, budget: 200000 }),
        });
        const itinerary = await res.json();
        document.getElementById("out").textContent = JSON.stringify(
          { slots, recs, itinerary },
          null,
          2
        );
      }
    </script>
  </body>
</html>
